<?xml version="1.0"?>
<openerp>
  <data>
    
    <!-- template for addressee-->
    <template id="report.external_report_to">
      <div class="vspace-xs clearleft" id="addressee">
        <t t-if="not o.partner_id.is_company">
          <t t-if="o.partner_id.name != o.partner_id.parent_id.name"> 
            <div t-field="o.partner_id.parent_id.name"/>
          </t>
        </t>
        <span t-field="o.partner_id.first_name"/>
        <span t-field="o.partner_id.name"/><br/>
        <div t-field="o.partner_id.street"/>
        <div class="vspace-s">
          <span t-field="o.partner_id.zip"/>
          <span t-field="o.partner_id.city"/>
        </div>
      </div>
    </template>
 
    <!-- create info template for company infos -->
    <template id="report.external_report_sender">
      <!-- Multicompany -->
      <t t-if="o and 'section_id' in o">
        <t t-set="company" t-value="o.section_id.company_id"/>
      </t>
      <t t-if="not o or not 'section_id' in o">
        <t t-if="o and 'company_id' in o">
          <t t-set="company" t-value="o.company_id"/>
        </t>
        <t t-if="not 'company_id' in o">
          <t t-set="company" t-value="res_company"/>
        </t>
      </t>

      <div class="small clearleft" style="padding-top:3.5cm">
        <span t-field="company.partner_id.name"/> &amp;middot;
        <span t-field="company.partner_id.street"/> &amp;middot;
        <span t-field="company.partner_id.zip"/>
        <span t-field="company.partner_id.city"/>
      </div>
    </template>

    <!-- Override external footer -->
    <template id="external_layout_footer" inherit_id="report.external_layout_footer">
      <xpath expr="//div[@class='footer']" position="replace">
        <!-- set proper company -->
        <t t-if="o and 'section_id' in o">
          <t t-set="company" t-value="o.section_id.company_id"/>
        </t>
        <t t-if="not o or not 'section_id' in o">
          <t t-if="o and 'company_id' in o">
            <t t-set="company" t-value="o.company_id"/>
          </t>
          <t t-if="not 'company_id' in o">
            <t t-set="company" t-value="res_company"/>
          </t>
        </t>
 
        <div class="footer small">
          <div t-raw="company.rml_footer"/>
        </div>
      </xpath>
    </template>

    <!-- Override external header, only show logo -->
    <template id="report.external_layout_header">
      <div class="header" style="text-align:right;">
        <!-- set proper company -->
        <t t-if="o and 'section_id' in o">
          <t t-set="company" t-value="o.section_id.company_id"/>
        </t>
        <t t-if="not o or not 'section_id' in o">
          <t t-if="o and 'company_id' in o">
            <t t-set="company" t-value="o.company_id"/>
          </t>
          <t t-if="not 'company_id' in o">
            <t t-set="company" t-value="res_company"/>
          </t>
        </t>
        <img t-if="company.logo" 
          t-att-src="'data:image/png;base64,%s' % company.logo" 
          style="max-width:6cm; max-height:3,5cm"/>
      </div>
    </template>

    <!-- Override style sheets -->
    <template id="report.style">
      footer {
        border-top: 1px solid black;
        text-align:center
      }
      body {
        color: #000 !important;
        font-family: Tahoma,Verdana,Segoe,sans-serif;
        font-size:10pt
        }
      .border-black td {
        border-top: 1px solid black !important;
        }
      .table-condensed > thead > tr > th {
        border-bottom: 1px solid black !important;
        }
      .zero_min_height {
        min-height: 0px !important;
        }
      /* by IT.artmin */
      #delivery {
        clear:right;
        min-width: 4.4cm;
        max-width: 7cm;
        }
      #addressee {
        max-width: 8cm;
      }
      th, td {
        padding-right: 0.2cm;
        font-size: 8pt;
        padding-bottom: 0.1cm;
        }
      .right {
        float: right;
        padding-right: 0cm;
        padding-bottom: 0cm;
        }
      .center {
        text-align: center;
        }
      .left {
        float: left
        }
      .clearleft {
        clear : left;
        }
      .clearright {
        clear : right;
        }
      .top {
        vertical-align: top;
        }
      .bottom {
        vertical-align: bottom;
        }
      .fullwidth {
        clear:left;
        clear:right;
        width: 100%;
        }
      .topLine {
        border-top: solid 1px black;
        }       
      .hspace-xs {
        margin-right: 0.2 cm;
        }
      .hspace-s {
        margin-right: 0.6cm
        }
      .hspace-m {
        margin-right: 1.3cm
        }
      .hspace-l {
        margin-right: 2cm
        }
      .vspace-xs {
        margin-top: 0.3cm
        }
      .vspace-s {
        margin-top: 0.6cm;
        }
      .vspace-m {
        margin-top: 1.3cm
        }
      .vspace-l {
        margin-top: 2cm
        }
      .normal {
         font-size: 10pt;
        }
      .small {
         font-size: 8pt
         }
      .x-small {
         font-size: 6.5pt;
         }
      .tiny {
         font-size: 0.1pt;
      }
      .title {
        font-size:16pt
        }
      .sum {
        font-size:10pt;
        font-weight:bold;
      }
      td.right {
        text-align:right;
        }
      #positions th {
        font-weight: bold;
        border-bottom: solid 2px black;
        }
      #positions th.right {
        float: none;
        text-align:right;
      }
      td.line {
        border-top: solid 1px black;
        }
      td.right {
        float:none;
        text-align:right;
        padding-left: 0.2cm;
        padding-right: 0cm;
        }
      .bg-grey {
        background-color: #d0d0d0;
        border: 5px solid #d0d0d0;
        }
    </template>
    
    <!-- Override margins in paper format -->
    <record id="report.paperformat_euro" model="report.paperformat">
      <field name="name">European A4</field>
      <field name="default" eval="True" />
      <field name="format">A4</field>
      <field name="page_height">0</field>
      <field name="page_width">0</field>
      <field name="orientation">Portrait</field>
      <field name="margin_top">20</field>
      <field name="margin_bottom">35</field>
      <field name="margin_left">14</field>
      <field name="margin_right">16</field>
      <field name="header_line" eval="False" />
      <field name="header_spacing">0</field>
      <field name="dpi">75</field>
    </record>
  </data>
</openerp>
